---
title: "Resnet18 Finetuning with FastAI"
format: html
---

```{python}
from fastai.vision.all import *
```


```{python}
work_dir = Path()
image_path = work_dir / "deep_learning/data/"
```


```{python}
image_path.resolve()
```


```{python}
item_tfms = RandomResizedCrop(460, min_scale=0.75)
batch_tfms = [*aug_transforms(size=224), Normalize.from_stats(*imagenet_stats)]
```


```{python}
dls = ImageDataLoaders.from_folder(image_path, train="train", valid="valid",
                                   item_tfms=item_tfms, batch_tfms=batch_tfms, bs = 64)
```


```{python}
learner = vision_learner(dls, resnet18, metrics = [accuracy, perplexity])
```


```{python}
lr_finder = learner.lr_find()
```


```{python}
lr_finder.valley
```


```{python}
learner.fine_tune(10, base_lr=0.001)
```